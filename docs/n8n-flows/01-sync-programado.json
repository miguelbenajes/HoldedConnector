{
  "name": "01 - Sync Holded programado",
  "nodes": [
    {
      "id": "a1b2c3d4-0001-0001-0001-a1b2c3d40001",
      "name": "Cada 6 horas",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [240, 300],
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "hours",
              "hoursInterval": 6
            }
          ]
        }
      }
    },
    {
      "id": "a1b2c3d4-0001-0001-0001-a1b2c3d40002",
      "name": "POST /api/sync",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [460, 300],
      "parameters": {
        "method": "POST",
        "url": "http://holded-api:8000/api/sync",
        "options": {
          "timeout": 300000,
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      }
    },
    {
      "id": "a1b2c3d4-0001-0001-0001-a1b2c3d40003",
      "name": "GET /api/backup/status",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [680, 300],
      "parameters": {
        "method": "GET",
        "url": "http://holded-api:8000/api/backup/status",
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      }
    },
    {
      "id": "a1b2c3d4-0001-0001-0001-a1b2c3d40004",
      "name": "Registrar sync",
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [900, 300],
      "parameters": {
        "operation": "create",
        "tableId": "sync_logs",
        "fieldsUi": {
          "fieldValues": [
            {"fieldId": "started_at", "fieldValue": "={{ new Date().toISOString() }}"},
            {"fieldId": "finished_at", "fieldValue": "={{ new Date().toISOString() }}"},
            {"fieldId": "status", "fieldValue": "ok"},
            {"fieldId": "counts", "fieldValue": "={{ JSON.stringify($json.record_counts) }}"}
          ]
        }
      },
      "credentials": {
        "supabaseApi": {
          "id": "SUPABASE_CREDENTIAL_ID",
          "name": "Supabase account"
        }
      }
    }
  ],
  "connections": {
    "Cada 6 horas": {
      "main": [
        [
          {
            "node": "POST /api/sync",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "POST /api/sync": {
      "main": [
        [
          {
            "node": "GET /api/backup/status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "GET /api/backup/status": {
      "main": [
        [
          {
            "node": "Registrar sync",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "meta": {
    "instanceId": ""
  },
  "tags": ["holded", "sync"]
}
